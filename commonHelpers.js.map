{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/markupMaker.js","../src/js/gallery.js"],"sourcesContent":["const PIXABAY_API_KEY = '40405988-c6d5b0647c8f4a8e4e473288b';\nimport axios from 'axios';\n\nexport async function fetchImages(query, pageNumber) {\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${pageNumber}&per_page=40`\n  );\n  return response.data;\n}","export function renderGallery(images, galleryContainer, gallery) {\n  const { hits } = images;\n  const markup = hits\n    .map(\n      ({\n        webformatURL,   // link to small image for photo card\n        largeImageURL,  // link to full size image\n        tags,           // image description string\n        likes,          // number of likes\n        views,          // number of views\n        comments,       // number of comments\n        downloads,      // number of downdloads\n      }) => {\n        return `<div class=\"photo-card\">    \n                  <a class=\"photo-card-link\" href=\"${largeImageURL}\">\n                    <img class=\"searched-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" data-title=\"${tags}\"/>\n                    <div class=\"info\">\n                      <p class=\"info-item\">\n                        <span class=\"info-title\">Likes</span>\n                        <span class=\"info-data\">${likes}</span>\n                      </p>\n                      <p class=\"info-item\">\n                        <span class=\"info-title\">Views</span>\n                        <span class=\"info-data\">${views}</span>\n                      </p>\n                      <p class=\"info-item\">\n                        <span class=\"info-title\">Comments</span>\n                        <span class=\"info-data\">${comments}</span>\n                      </p>\n                      <p class=\"info-item\">\n                        <span class=\"info-title\">Downloads</span>\n                        <span class=\"info-data\">${downloads}\n                      </p></span>\n                    </div>\n                  </a>\n              </div>`;\n      }\n    )\n    .join('');\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n  gallery.refresh();\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages } from './api';\nimport { renderGallery } from './markupMaker';\n\nconst CARD_ITEMS_PER_PAGE = 40;\nconst DISPLAY_MAX_PAGE_NUMBER = 10;  // limit for the number of pages to load\n\nlet page;\nlet userInput;\n\niziToast.settings({\n  position: 'topRight',\n  timeout: 3000,\n  maxWidth: 400,\n  progressBar: false,\n  transitionIn: 'fadeIn',\n  transitionOut: 'fadeOut',\n});\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionType: 'data',\n  captionDelay: 250,\n});\n\nconst form = document.querySelector('#search-form');\nconst galleryContainer = document.querySelector('.js-gallery');\nconst loadMoreBtn = document.querySelector('.js-load-more-btn');\nconst endOfGalleryMsg = document.querySelector('.js-end-of-img-list');\n\nform.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMoreContent);\n\n/**\n * * Handles search form search input and populates gallery with card items.\n * @param {Event} event Ocured event.\n * Shows warning message, if query search is empty.\n * Shows error message, if no search results found.\n * Shows success message with number of found items when sound items.\n * Displays button for loading more content when more content is available.  \n * Displays message for end of content when there no more content and eached the end.\n */\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n\n  page = 1; // reset page number to one on each new search\n  userInput = event.target.searchQuery.value.trim();\n  if (!userInput) {\n    iziToast.warning({\n      title: 'Please specify search criteria!',\n      message: 'The search query cannot be empty.',\n    });\n    return;\n  }\n\n  galleryContainer.innerHTML = ''; // clear previously populated gallery content\n  loadMoreBtn.style.display = 'none'; // hide button for loading more content\n  endOfGalleryMsg.style.display = 'none'; // hide message info message about reaching end of the content\n  \n  try {\n    const content = await fetchImages(userInput, page); // fetch images based on user query\n    \n    if (!content.hits.length) {\n      iziToast.error({\n        title: 'Sorry, there are no images matching your search query.',\n        message: `Please try again.`,\n      });\n      event.target.searchQuery.value = '';\n      return;\n    }\n\n    event.target.searchQuery.value = ''; // clear input field\n    renderGallery(content, galleryContainer, gallery); // render gallery content, refresh Simplelightbox\n    \n    iziToast.success({\n      title: 'Hooray!',\n      message: `We found ${content.totalHits} images.`,\n    });\n    \n    if (content.hits.length < CARD_ITEMS_PER_PAGE) {\n      endOfGalleryMsg.style.display = 'block';\n      return;\n    }\n    loadMoreBtn.style.display = 'block';\n  } catch (error) {\n    iziToast.error({\n      title: 'Oops. An error has occurred',\n      message: `${error.message}.`,\n    });\n    console.log(error.message);\n  }\n}\n\n/**\n * * Handles more content load and adding it to the end of the gallery.\n * Displays button for loading more content when more content is available.  \n * Displays message for end of content when there no more content and eached the end.\n */\nasync function onLoadMoreContent() {\n  page++; // increase page number by 1 with each request\n  loadMoreBtn.visibility = 'hidden'; // visually hide button for loading more content\n  \n  try {\n    const content = await fetchImages(userInput, page);\n    renderGallery(content, galleryContainer, gallery); // render gallery content with new images, refresh Simplelightbox\n    galleryLoaded(); // apply smooth scrolling\n    \n    if (page === DISPLAY_MAX_PAGE_NUMBER) {\n      loadMoreBtn.style.display = 'none';\n      endOfGalleryMsg.style.display = 'block';\n      return;\n    }\n    \n    if (content.hits.length < CARD_ITEMS_PER_PAGE || !content.hits.length) {\n      loadMoreBtn.style.display = 'none';\n      endOfGalleryMsg.style.display = 'block';\n      return;\n    }\n    loadMoreBtn.visibility = 'visible'; // show button for loading more content\n  } catch (error) {\n    iziToast.error({\n      title: 'Oops. An error has occurred',\n      message: `${error.message}`,\n    });\n    console.log(error.message);\n  }\n}\n\n/**\n * * Applies smooth scrolling\n */\nfunction galleryLoaded() {\n  const { height: cardHeight } = document.querySelector('.photo-card').getBoundingClientRect();\n  const height = window.innerHeight;\n  window.scrollBy({\n    top: height - cardHeight,\n    behavior: 'smooth',\n  });\n}"],"names":["PIXABAY_API_KEY","fetchImages","query","pageNumber","axios","renderGallery","images","galleryContainer","gallery","hits","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","CARD_ITEMS_PER_PAGE","DISPLAY_MAX_PAGE_NUMBER","page","userInput","iziToast","SimpleLightbox","form","loadMoreBtn","endOfGalleryMsg","onSearchFormSubmit","onLoadMoreContent","event","content","error","galleryLoaded","cardHeight","height"],"mappings":"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"}